{"version":3,"file":"addplant-BTbYgSwq.js","sources":["../../../../frontend/src/addPlant.js"],"sourcesContent":["import LoginService from './loginService.js';\r\n\r\nlet service = new LoginService();\r\n\r\nfunction refresh() {\r\n    if (service.isLoggedIn()) {\r\n        document.forms.login.style = \"display:none\";\r\n        document.forms.logout.style = \"display:block\";\r\n        service.getUser().then(user => {\r\n            if (user) {\r\n                document.getElementById('user').textContent = user.username;\r\n            }\r\n        });\r\n    } else {\r\n        document.forms.logout.style = \"display:none\";\r\n        document.forms.login.style = \"display:block\";\r\n    }\r\n}\r\n\r\ndocument.forms.login.addEventListener('submit', e => {\r\n    e.preventDefault();\r\n    service.login(document.forms.login.username.value, document.forms.login.password.value).then(() => {\r\n        window.location.reload();\r\n    }).catch(error => {\r\n        alert(error);\r\n    });\r\n});\r\n\r\ndocument.forms.logout.addEventListener('submit', e => {\r\n    e.preventDefault();\r\n    service.logout().then(() => {\r\n        window.location.reload();\r\n    });\r\n});\r\n\r\ndocument.getElementById(\"add-plant-form\").addEventListener(\"submit\", function(event) {\r\n    event.preventDefault();\r\n    \r\n    const plantData = {\r\n        id: document.getElementById(\"id\").value,\r\n        scientific_name: document.getElementById(\"scientific_name\").value,\r\n        description: document.getElementById(\"description\").value,\r\n        bloom_time: document.getElementById(\"bloom_time\").value,\r\n        height: document.getElementById(\"height\").value,\r\n        width: document.getElementById(\"width\").value,\r\n        sun_requirements: document.getElementById(\"sun_requirements\").value,\r\n        soil_type: document.getElementById(\"soil_type\").value,\r\n        water_needs: document.getElementById(\"water_needs\").value\r\n    };\r\n\r\n    fetch('/api/plants', {\r\n        method: 'POST',\r\n        headers: {\r\n            'Content-Type': 'application/json',\r\n            \"Authorization\": \"Bearer \" + window.localStorage.getItem(\"token\")\r\n        },\r\n        body: JSON.stringify(plantData)\r\n    })\r\n    .then(response => {\r\n        if (response.status === 201) {\r\n            return response.json();\r\n        } else if (response.status === 409) {\r\n            return response.text().then(text => { throw new Error(text); });\r\n        } else if (response.status === 403) {\r\n            return new Error(\"You are not authorized to add a plant.\");\r\n        } else {\r\n            throw new Error(\"Failed to add plant.\");\r\n        }\r\n    })\r\n    .then(data => {\r\n        alert(\"Plant added!\");\r\n        document.getElementById(\"add-plant-form\").reset();\r\n    })\r\n    .catch(error => {\r\n        console.error(\"Error adding plant:\", error);\r\n        alert(error.message);\r\n    });\r\n});\r\n\r\nrefresh();\r\n\r\nservice.getUser().then(user => {\r\n    if (!user) {\r\n        service.logout();\r\n    }\r\n    refresh();\r\n});"],"names":["service","LoginService","refresh","user","error","event","plantData","response","text","data"],"mappings":"2EAEA,IAAIA,EAAU,IAAIC,EAElB,SAASC,GAAU,CACXF,EAAQ,cACR,SAAS,MAAM,MAAM,MAAQ,eAC7B,SAAS,MAAM,OAAO,MAAQ,gBAC9BA,EAAQ,QAAO,EAAG,KAAKG,GAAQ,CACvBA,IACA,SAAS,eAAe,MAAM,EAAE,YAAcA,EAAK,SAEnE,CAAS,IAED,SAAS,MAAM,OAAO,MAAQ,eAC9B,SAAS,MAAM,MAAM,MAAQ,gBAErC,CAEA,SAAS,MAAM,MAAM,iBAAiB,SAAU,GAAK,CACjD,EAAE,eAAc,EAChBH,EAAQ,MAAM,SAAS,MAAM,MAAM,SAAS,MAAO,SAAS,MAAM,MAAM,SAAS,KAAK,EAAE,KAAK,IAAM,CAC/F,OAAO,SAAS,QACxB,CAAK,EAAE,MAAMI,GAAS,CACd,MAAMA,CAAK,CACnB,CAAK,CACL,CAAC,EAED,SAAS,MAAM,OAAO,iBAAiB,SAAU,GAAK,CAClD,EAAE,eAAc,EAChBJ,EAAQ,SAAS,KAAK,IAAM,CACxB,OAAO,SAAS,QACxB,CAAK,CACL,CAAC,EAED,SAAS,eAAe,gBAAgB,EAAE,iBAAiB,SAAU,SAASK,EAAO,CACjFA,EAAM,eAAc,EAEpB,MAAMC,EAAY,CACd,GAAI,SAAS,eAAe,IAAI,EAAE,MAClC,gBAAiB,SAAS,eAAe,iBAAiB,EAAE,MAC5D,YAAa,SAAS,eAAe,aAAa,EAAE,MACpD,WAAY,SAAS,eAAe,YAAY,EAAE,MAClD,OAAQ,SAAS,eAAe,QAAQ,EAAE,MAC1C,MAAO,SAAS,eAAe,OAAO,EAAE,MACxC,iBAAkB,SAAS,eAAe,kBAAkB,EAAE,MAC9D,UAAW,SAAS,eAAe,WAAW,EAAE,MAChD,YAAa,SAAS,eAAe,aAAa,EAAE,KAC5D,EAEI,MAAM,cAAe,CACjB,OAAQ,OACR,QAAS,CACL,eAAgB,mBAChB,cAAiB,UAAY,OAAO,aAAa,QAAQ,OAAO,CACnE,EACD,KAAM,KAAK,UAAUA,CAAS,CACtC,CAAK,EACA,KAAKC,GAAY,CACd,GAAIA,EAAS,SAAW,IACpB,OAAOA,EAAS,OACb,GAAIA,EAAS,SAAW,IAC3B,OAAOA,EAAS,OAAO,KAAKC,GAAQ,CAAE,MAAM,IAAI,MAAMA,CAAI,CAAE,CAAE,EAC3D,GAAID,EAAS,SAAW,IAC3B,OAAO,IAAI,MAAM,wCAAwC,EAEzD,MAAM,IAAI,MAAM,sBAAsB,CAElD,CAAK,EACA,KAAKE,GAAQ,CACV,MAAM,cAAc,EACpB,SAAS,eAAe,gBAAgB,EAAE,MAAK,CACvD,CAAK,EACA,MAAML,GAAS,CACZ,QAAQ,MAAM,sBAAuBA,CAAK,EAC1C,MAAMA,EAAM,OAAO,CAC3B,CAAK,CACL,CAAC,EAEDF,IAEAF,EAAQ,QAAO,EAAG,KAAKG,GAAQ,CACtBA,GACDH,EAAQ,OAAM,EAElBE,GACJ,CAAC"}