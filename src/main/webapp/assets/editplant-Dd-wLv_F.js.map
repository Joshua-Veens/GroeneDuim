{"version":3,"file":"editplant-Dd-wLv_F.js","sources":["../../../../frontend/src/editPlant.js"],"sourcesContent":["import LoginService from './loginService.js';\r\n\r\nlet service = new LoginService();\r\n\r\nfunction refresh() {\r\n    if (service.isLoggedIn()) {\r\n        document.forms.login.style = \"display:none\";\r\n        document.forms.logout.style = \"display:block\";\r\n        service.getUser().then(user => {\r\n            if (user) {\r\n                document.getElementById('user').textContent = user.username;\r\n            }\r\n        });\r\n    } else {\r\n        document.forms.logout.style = \"display:none\";\r\n        document.forms.login.style = \"display:block\";\r\n    }\r\n}\r\n\r\ndocument.forms.login.addEventListener('submit', e => {\r\n    e.preventDefault();\r\n    service.login(document.forms.login.username.value, document.forms.login.password.value).then(() => {\r\n        window.location.reload();\r\n    }).catch(error => {\r\n        alert(error);\r\n    });\r\n});\r\n\r\ndocument.forms.logout.addEventListener('submit', e => {\r\n    e.preventDefault();\r\n    service.logout().then(() => {\r\n        window.location.reload();\r\n    });\r\n});\r\n\r\ndocument.getElementById(\"search-plant-button\").addEventListener(\"click\", function() {\r\n    const plantId = document.getElementById(\"search-id\").value;\r\n    \r\n    fetch(`/api/plants/${plantId}`, {\r\n        method: 'GET',\r\n        headers: {\r\n            'Content-Type': 'application/json',\r\n            \"Authorization\": \"Bearer \" + window.localStorage.getItem(\"token\")\r\n        }\r\n    })\r\n    .then(response => response.json())\r\n    .then(data => {\r\n        document.getElementById(\"id\").value = data.id;\r\n        document.getElementById(\"scientific_name\").value = data.scientific_name;\r\n        document.getElementById(\"description\").value = data.description;\r\n        document.getElementById(\"bloom_time\").value = data.bloom_time;\r\n        document.getElementById(\"height\").value = data.height;\r\n        document.getElementById(\"width\").value = data.width;\r\n        document.getElementById(\"sun_requirements\").value = data.sun_requirements;\r\n        document.getElementById(\"soil_type\").value = data.soil_type;\r\n        document.getElementById(\"water_needs\").value = data.water_needs;\r\n        document.getElementById(\"edit-plant-form\").style.display = \"block\";\r\n    })\r\n    .catch(error => {\r\n        console.error(\"Error fetching plant:\", error);\r\n        alert(\"Plant not found\");\r\n    });\r\n});\r\n\r\ndocument.getElementById(\"edit-plant-form\").addEventListener(\"submit\", function(event) {\r\n    event.preventDefault();\r\n    \r\n    const plantData = {\r\n        id: document.getElementById(\"id\").value,\r\n        scientific_name: document.getElementById(\"scientific_name\").value,\r\n        description: document.getElementById(\"description\").value,\r\n        bloom_time: document.getElementById(\"bloom_time\").value,\r\n        height: document.getElementById(\"height\").value,\r\n        width: document.getElementById(\"width\").value,\r\n        sun_requirements: document.getElementById(\"sun_requirements\").value,\r\n        soil_type: document.getElementById(\"soil_type\").value,\r\n        water_needs: document.getElementById(\"water_needs\").value\r\n    };\r\n\r\n    fetch(`/api/plants/${plantData.id}`, {\r\n        method: 'PUT',\r\n        headers: {\r\n            'Content-Type': 'application/json',\r\n            \"Authorization\": \"Bearer \" + window.localStorage.getItem(\"token\")\r\n        },\r\n        body: JSON.stringify(plantData)\r\n    })\r\n    .then(response => {\r\n        if (response.status === 200) {\r\n            return response.json();\r\n        } else {\r\n            throw new Error(\"Failed to update plant.\");\r\n        }\r\n    })\r\n    .then(data => {\r\n        alert(\"Plant updated successfully\");\r\n        document.getElementById(\"edit-plant-form\").reset();\r\n        document.getElementById(\"edit-plant-form\").style.display = \"none\";\r\n    })\r\n    .catch(error => {\r\n        console.error(\"Error updating plant:\", error);\r\n        alert(error.message);\r\n    });\r\n});\r\n\r\nrefresh();\r\n\r\nservice.getUser().then(user => {\r\n    if (!user) {\r\n        service.logout();\r\n    }\r\n    refresh();\r\n});\r\n"],"names":["service","LoginService","refresh","user","e","error","plantId","response","data","event","plantData"],"mappings":"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"}